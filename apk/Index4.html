<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FFCINE FILMES ONLINE</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

<style>
body {
  margin: 0;
  background: #141414;
  font-family: Arial, sans-serif;
  color: white;
}

/* HEADER */
.top-header {
  position: sticky;
  top: 0;
  z-index: 3000;
  background: black;
  padding: 12px;
  font-size: 22px;
  font-weight: bold;
  color: red;
  text-align: center;
}

/* INSTALL */
#installBox {
  display: none;
  text-align: center;
  background: #000;
  padding: 10px;
  position: sticky;
  top: 52px;
  z-index: 2600;
}
#installBox button {
  background: red;
  color: white;
  border: none;
  padding: 10px 22px;
  border-radius: 20px;
  font-size: 15px;
  cursor: pointer;
}

/* BUSCA */
.search-box {
  padding: 12px;
  background: #000;
  position: sticky;
  top: 92px;
  z-index: 2500;
}
.search-box input {
  width: 100%;
  padding: 14px;
  border-radius: 30px;
  border: none;
  font-size: 16px;
}

/* PLAYER */
.player {
  width: 100%;
  height: 60vh;
  position: sticky;
  top: 140px;
  background: black;
  border-radius: 12px;
  overflow: hidden;
  z-index: 2000;
}
.player iframe {
  width: 100%;
  height: 100%;
  border: none;
}

/* PLAY OVERLAY */
.play-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,.6);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}
.play-overlay span {
  font-size: 90px;
  background: rgba(0,0,0,.7);
  border-radius: 50%;
  padding: 20px 32px;
}

/* CAT√ÅLOGO */
.container {
  padding: 15px;
}
.catalog-title {
  margin: 20px 10px 10px;
  font-size: 20px;
}
.row {
  display: flex;
  gap: 12px;
  overflow-x: auto;
  padding: 10px;
}
.row::-webkit-scrollbar { display: none; }

.movie {
  min-width: 140px;
  cursor: pointer;
  transition: transform .3s;
}
.movie:hover { transform: scale(1.12); }
.movie img {
  width: 100%;
  border-radius: 10px;
}
.movie-title {
  text-align: center;
  font-size: 13px;
  margin-top: 5px;
}
</style>
</head>

<body>

<header class="top-header">FFCINE FILMES ONLINE</header>

<div id="installBox">
  <button onclick="installPWA()">üì≤ Instalar App</button>
</div>

<div class="search-box">
  <input id="searchInput" placeholder="Buscar filme..." onkeyup="searchMovies()">
</div>

<div class="container">

<!-- PLAYER -->
<div class="player">
  <div class="play-overlay" id="playOverlay" onclick="resumeLastVideo()">
    <span>‚ñ∂</span>
  </div>
  <iframe id="mainPlayer"
    src="https://www.youtube.com/embed/D1ZRzmHd2Uk?enablejsapi=1">
  </iframe>
</div>

<!-- CAT√ÅLOGO -->
<h2 class="catalog-title">üî• Em destaque</h2>
<div class="row" id="movieGallery">

  <div class="movie" data-video="ISgmlhSJopU" data-genre="acao">
<img src="https://img.youtube.com/vi/ISgmlhSJopU/hqdefault.jpg">
<div class="movie-title">XIII - A Conspira√ß√£o</div>
</div>


<div class="movie" data-video="aagGsNT_ly8" data-genre="comedia">
<img src="https://img.youtube.com/vi/aagGsNT_ly8/hqdefault.jpg">
<div class="movie-title">Meu Novo Brinquedo</div>
</div>

<div class="movie comedia" data-genero="comedia" onclick="playMovie('Zkcs1rvDPbs')">
  <img src="https://img.youtube.com/vi/Zkcs1rvDPbs/hqdefault.jpg">
  <div class="movie-title">O filme de com√©dia mais engra√ßado para assistir √† noite</div>
</div>

<div class="movie" data-video="_J-tObfmlQA" data-genre="ficcao">
<img src="https://img.youtube.com/vi/_J-tObfmlQA/hqdefault.jpg">
<div class="movie-title">Super-Her√≥i</div>
</div>
<div class="movie acao" data-genero="acao" onclick="playMovie('eecbS-qCZXc')">
  <img src="https://img.youtube.com/vi/eecbS-qCZXc/hqdefault.jpg">
  <div class="movie-title">O Lobo FILME COMPLETO DUBLADO</div>
</div>

</div>

<script>
/* ===== PWA ===== */
let deferredPrompt;
window.addEventListener('beforeinstallprompt', e => {
  e.preventDefault();
  deferredPrompt = e;
  installBox.style.display = 'block';
});
function installPWA() {
  deferredPrompt.prompt();
  deferredPrompt = null;
  installBox.style.display = 'none';
}

/* ===== EMBARALHAR ===== */
const gallery = document.getElementById('movieGallery');
[...gallery.children]
  .sort(() => Math.random() - 0.5)
  .forEach(el => gallery.appendChild(el));

/* ===== PLAYER ===== */
let currentVideo = null;
let player;

function onYouTubeIframeAPIReady() {
  player = new YT.Player('mainPlayer', {
    events: { onStateChange }
  });
}

function onStateChange(e) {
  if (e.data === YT.PlayerState.PLAYING) {
    playOverlay.style.display = 'none';
    setInterval(saveProgress, 5000);
  }
}

function saveProgress() {
  if (player && currentVideo) {
    localStorage.setItem(
      'video_' + currentVideo,
      player.getCurrentTime()
    );
  }
}

/* PLAY FILME */
document.querySelectorAll('.movie').forEach(m => {
  m.onclick = () => {
    currentVideo = m.dataset.video;
    const time = localStorage.getItem('video_' + currentVideo) || 0;
    mainPlayer.src =
      `https://www.youtube.com/embed/${currentVideo}?autoplay=1&start=${Math.floor(time)}&enablejsapi=1`;
  };
});

function resumeLastVideo() {
  if (!currentVideo) return;
  const time = localStorage.getItem('video_' + currentVideo) || 0;
  mainPlayer.src =
    `https://www.youtube.com/embed/${currentVideo}?autoplay=1&start=${Math.floor(time)}&enablejsapi=1`;
}

/* BUSCA */
function searchMovies() {
  const t = searchInput.value.toLowerCase();
  document.querySelectorAll('.movie').forEach(m => {
    m.style.display = m.innerText.toLowerCase().includes(t) ? 'block' : 'none';
  });
}

/* YT API */
const tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
document.body.appendChild(tag);
</script>

</body>
</html>
