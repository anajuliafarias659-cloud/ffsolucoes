<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Acompanhar Servi√ßo</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#0b1b29;
  color:#fff;
  padding:20px;
}

h1{
  text-align:center;
  color:#1de9b6;
}

.container{
  max-width:500px;
  margin:30px auto;
  background:linear-gradient(135deg,#2f8f4e,#4b1fa0);
  padding:25px;
  border-radius:20px;
}

input,button{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  margin-top:12px;
  font-size:16px;
}

button{
  background:#fff;
  font-weight:bold;
  cursor:pointer;
}

.resultado{
  margin-top:20px;
  font-size:18px;
}

.resultado p{
  margin:10px 0;
}
</style>
</head>

<body>

<h1>üìã Acompanhar Servi√ßo</h1>

<div class="container">
  <input type="text" id="codigoInput" placeholder="Digite seu c√≥digo (ex: ORC-3399)">
  <button onclick="verificar()">Verificar</button>

  <div class="resultado" id="resultado"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

/* FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "AIzaSyBgar59yF1k6XmfG0iNOXvWCWKIa9dHcdI",
  authDomain: "servicospc-b3382.firebaseapp.com",
  projectId: "servicospc-b3382"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const resultado = document.getElementById("resultado");

let unsubscribe = null;

window.verificar = () => {

  const codigo = document.getElementById("codigoInput").value.trim().toUpperCase();

  if(!codigo){
    alert("Digite o c√≥digo");
    return;
  }

  resultado.innerHTML = "Carregando...";

  if(unsubscribe){
    unsubscribe(); // cancela listener anterior
  }

  const servicoRef = doc(db, "servicos", codigo);

  unsubscribe = onSnapshot(servicoRef, (docSnap) => {

    if(!docSnap.exists()){
      resultado.innerHTML = "<p>‚ùå C√≥digo n√£o encontrado.</p>";
      return;
    }

    const dados = docSnap.data();

    resultado.innerHTML = `
      <p><strong>Nome:</strong> ${dados.nome}</p>
      <p><strong>Status:</strong> ${dados.status}</p>
      <p><strong>Problema:</strong> ${dados.problema || "N√£o informado"}</p>
    `;
  });
};
</script>

</body>
</html>
