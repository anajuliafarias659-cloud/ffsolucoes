<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Loja</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
*{box-sizing:border-box}
body{margin:0;font-family:Arial;background:#020617;color:#fff}
:root{--p:#22c55e}

/* ===== TEMAS ===== */
body.tema-natal{--p:#ef4444;background:#1a0b0b}
body.tema-anonovo{--p:#22c55e;background:#052e16}
body.tema-saojoao{--p:#f59e0b;background:#2a1505}
body.tema-carnaval{--p:#a855f7;background:#1e0b2e}
body.tema-preto{--p:#000;background:#000}

/* ===== BANNER ===== */
.banner{height:260px;background:#0f172a}
.banner img{width:100%;height:100%;object-fit:cover}

/* ===== TOPO ===== */
.topo{text-align:center;padding:24px;background:#0f172a}

/* ===== GRID ===== */
.container{padding:20px;max-width:1200px;margin:auto}
.grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(160px,1fr))}
.card{background:#0f172a;padding:12px;border-radius:14px;text-align:center}
.card img{width:100%;height:160px;object-fit:cover;border-radius:10px;cursor:pointer}
.botao{margin-top:8px;width:100%;padding:10px;border:none;border-radius:10px;background:var(--p);font-weight:bold}

/* ===== CARRINHO BTN ===== */
#btnCarrinho{
position:fixed;bottom:20px;right:20px;
width:60px;height:60px;border-radius:50%;
background:var(--p);font-size:22px;border:none
}
#badge{
position:absolute;top:-5px;right:-5px;
background:red;color:#fff;border-radius:50%;
padding:2px 7px;font-size:12px;display:none
}

/* ===== MODAL CARRINHO ===== */
.modalCarrinho{
position:fixed;inset:0;background:rgba(0,0,0,.85);
display:none;align-items:center;justify-content:center;z-index:1500
}
.carrinhoBox{
background:#020617;padding:20px;border-radius:16px;
width:420px;max-width:95%;max-height:90vh;overflow-y:auto
}
.item{display:flex;justify-content:space-between;margin-bottom:6px}
.item button{background:red;color:#fff;border:none;border-radius:6px;padding:2px 8px}

/* ===== FORM PREMIUM ===== */
.form{
background:#0f172a;
padding:20px;
border-radius:18px;
margin-top:16px;
box-shadow:0 15px 40px rgba(0,0,0,.5);
}

.campo{
display:flex;
flex-direction:column;
margin-bottom:16px;
}

.campo label{
font-size:13px;
margin-bottom:6px;
color:#94a3b8;
font-weight:600;
}

.form input,
.form select{
width:100%;
padding:14px;
border-radius:14px;
border:1px solid #1e293b;
background:#0b1220;
color:#fff;
font-size:16px;
outline:none;
transition:.2s;
}

.form input:focus,
.form select:focus{
border-color:var(--p);
box-shadow:0 0 0 4px rgba(34,197,94,.15);
}

.linha{
display:flex;
gap:12px;
}

.linha .campo{
flex:1;
}

.btnLocal{
width:100%;
padding:14px;
border-radius:14px;
border:1px solid #334155;
background:#1e293b;
color:#fff;
font-weight:600;
margin-bottom:18px;
cursor:pointer;
}

.form .botao{
width:100%;
padding:16px;
border-radius:16px;
background:var(--p);
color:#000;
font-weight:800;
font-size:17px;
border:none;
cursor:pointer;
box-shadow:0 8px 20px rgba(34,197,94,.4);
}

/* ===== MODAL IMAGEM ===== */
.modalImagem{
position:fixed;inset:0;background:rgba(0,0,0,.95);
display:none;align-items:center;justify-content:center;z-index:2000
}
.galeria{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center}
.galeria img{max-width:90%;max-height:80%;border-radius:14px}
.fechar{position:absolute;top:16px;right:16px;font-size:28px;cursor:pointer}
.contador{position:absolute;bottom:70px;background:rgba(0,0,0,.6);padding:6px 12px;border-radius:20px}
.indicadores{position:absolute;bottom:30px;display:flex;gap:10px;background:rgba(0,0,0,.4);padding:8px 14px;border-radius:30px}
.indicadores span{width:10px;height:10px;border-radius:50%;background:#64748b;cursor:pointer}
.indicadores span.ativo{background:var(--p)}
</style>
</head>

<body>

<div id="banner" class="banner"></div>

<div class="topo">
<h1 id="nomeLoja"></h1>
<p id="descLoja"></p>
</div>

<div class="container">
<div id="produtos" class="grid"></div>
</div>

<button id="btnCarrinho" onclick="abrirCarrinho()">
üõí <span id="badge">0</span>
</button>

<div class="modalCarrinho" id="modalCarrinho">
<div class="carrinhoBox">
<h3>Carrinho</h3>
<div id="listaCarrinho"></div>
<p><b>Total:</b> R$ <span id="total">0.00</span></p>

<div class="form">

<div class="campo">
<label for="cliNome">üë§ Nome completo</label>
<input id="cliNome" name="cliNome" placeholder="Digite seu nome">
</div>

<div class="campo">
<label for="cliEndereco">üè† Endere√ßo</label>
<input id="cliEndereco" name="cliEndereco" placeholder="Rua / Avenida">
</div>

<div class="linha">
<div class="campo">
<label for="cliNumero">üî¢ N√∫mero</label>
<input id="cliNumero" name="cliNumero" placeholder="N¬∫">
</div>

<div class="campo">
<label for="cliReferencia">üìç Refer√™ncia</label>
<input id="cliReferencia" name="cliReferencia" placeholder="Ponto de refer√™ncia">
</div>
</div>

<button type="button" class="btnLocal" onclick="usarLocalizacao()">
üìç Usar minha localiza√ß√£o
</button>

<div class="campo">
<label for="pagamento">üí≥ Forma de pagamento</label>
<select id="pagamento" name="pagamento" onchange="verificarPagamento()">
<option value="PIX">PIX</option>
<option value="Cart√£o">Cart√£o</option>
<option value="Dinheiro">Dinheiro</option>
</select>
</div>

<div id="trocoArea" style="display:none;">
<div class="campo">
<label for="trocoValor">üíµ Troco para quanto?</label>
<input id="trocoValor" name="trocoValor" placeholder="Ex: 100.00">
</div>
</div>

<button type="button" class="botao" onclick="finalizar()">
Enviar pedido no WhatsApp
</button>

</div>

<button onclick="fecharCarrinho()">Fechar</button>
</div>
</div>

<script>
const sb=supabase.createClient("https://pdajixsoowcyhnjwhgpc.supabase.co","sb_publishable_LatlFlcxk6IchHe3RNmfwA_9Oq4EsZw");
const app=new URLSearchParams(location.search).get("app");
if(!app){document.body.innerHTML="Link inv√°lido";throw""}

const carrinhoKey="carrinho_"+app;
let carrinho=JSON.parse(localStorage.getItem(carrinhoKey))||[];
let fotosProduto={},fotosAtuais=[],indice=0,autoPlay=null,WHATS="";

function verificarPagamento(){
if(pagamento.value==="Dinheiro"){
trocoArea.style.display="block";
}else{
trocoArea.style.display="none";
trocoValor.value="";
}
}

/* restante do seu JS continua igual ao anterior */
</script>

</body>
</html>
