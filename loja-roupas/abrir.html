<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Abrindo loja...</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:#020617;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100vh;
  font-family:Arial,sans-serif;
  text-align:center;
}
.box{padding:30px}
.loader{
  margin:20px auto;
  width:42px;
  height:42px;
  border:4px solid #1e293b;
  border-top:4px solid #22c55e;
  border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}
small{opacity:.7}
</style>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>

<div class="box">
  <h2>Abrindo loja</h2>
  <div class="loader"></div>
  <small>Carregando catálogo…</small>
</div>

<script>
/* ===== SUPABASE ===== */
const sb = supabase.createClient(
  "https://pdajixsoowcyhnjwhgpc.supabase.co",
  "sb_publishable_LatlFlcxk6IchHe3RNmfwA_9Oq4EsZw"
);

/* ===== CONFIG DA LOJA ===== */
const APP_ID = "a724a269-84c1-44cc-9fbd-5532c61414a1";

/* páginas */
const PAGINA_VITRINE = "index.html";
const PAGINA_CARDAPIO = "cardapio.html";

/* salva a chave */
localStorage.setItem("APP_ID", APP_ID);

/* decide o destino */
async function abrirLoja(){
  const { data } = await sb
    .from("config_site")
    .select("usar_cardapio")
    .eq("app_id", APP_ID)
    .maybeSingle();

  /* LOJA NORMAL (vitrine) */
  if(!data || !data.usar_cardapio){
    window.location.href = `${PAGINA_VITRINE}?app=${APP_ID}`;
    return;
  }

  /* SE UM DIA VIRAR DELIVERY */
  window.location.href = `${PAGINA_CARDAPIO}?app=${APP_ID}`;
}

abrirLoja();
</script>

</body>
</html>
